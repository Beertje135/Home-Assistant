
alias: Notify Alexa - Dusty - Status
sequence:
  - condition: template
    value_template: "{{ states('group.bewoners') in ['home'] or states('group.bezoekers') in ['home']}}"
  - condition: template
    value_template: "{{ states('input_select.woning_status') not in ['Slapen'] }}"
  - wait_template: "{{ is_state('group.bewoners_router', 'home') }}"
    timeout: '00:05:00'
    continue_on_timeout: false
  - delay: 00:00:10
  - service: notify.alexa_media
    data_template:
      target:
        - media_player.kitchen_alexa_2
        - media_player.bathroom_alexa
      message: >
        {% if states.vacuum.dusty.attributes.status == 'Stuck' %}
          'Dusty is stuck. Stupid Dusty'
        {% elif states.vacuum.dusty.attributes.bin_full == true %}
          'Dusty has eaten to much. Please empty his belly.'
        {% elif states('vacuum.dusty') in ['off'] and states('input_boolean.vacuum_cleaned_today') in ['on'] %}
          'Dusty has completed his task.'
        {% elif states('vacuum.dusty') in ['off'] and states('input_boolean.vacuum_cleaned_today') in ['off'] %}
          'Dusty still hasn't completed his task today'
        {% elif states('vacuum.dusty') in ['on'] %}
          'Dusty starts cleaning the house. Beep Beep'
        {% else %}
          'Dusty is still going strong'
        {% endif %}
      data:
        type: announce
        method: speak
