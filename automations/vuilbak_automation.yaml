# AUTOMATIONS WHEN WASTE NEEDS TO BE OUTSIDE CHANGES

- alias: Vuilbakken - Reminder voor avond
  trigger:
  - platform: time
    at: '20:30:00'
  condition:
  - condition: template
    value_template: "{{ states('input_select.woning_status') in ['Juist Thuis', 'Thuis', 'Dag Thuis'] }}"
  - condition: template
    value_template: "{{ ((as_timestamp(now())+ (86400)) | timestamp_custom('%Y-%m-%d',true) == states.sensor.ophaalkalender_restafval.state) or ((as_timestamp(now())+ (86400)) | timestamp_custom('%Y-%m-%d',true) == states.sensor.ophaalkalender_papier.state) or ((as_timestamp(now())+ (86400)) | timestamp_custom('%Y-%m-%d',true) == states.sensor.ophaalkalender_pmd.state) }}"
  action:
  - service: script.turn_on
    entity_id: script.notify_waste

- alias: Vuilbakken - Status Woning Changes
  trigger:
  - platform: state
    entity_id: input_select.woning_status
    from: 'Juist Thuis'
    to: 'Thuis'
  - platform: state
    entity_id: input_select.woning_status
    from: 'Juist Thuis'
    to: 'Dag Thuis'
  condition:
  - condition: template
    value_template: "{{ ((as_timestamp(now())+ (86400)) | timestamp_custom('%Y-%m-%d',true) == states.sensor.ophaalkalender_restafval.state) or ((as_timestamp(now())+ (86400)) | timestamp_custom('%Y-%m-%d',true) == states.sensor.ophaalkalender_papier.state) or ((as_timestamp(now())+ (86400)) | timestamp_custom('%Y-%m-%d',true) == states.sensor.ophaalkalender_pmd.state) }}"
  action:
  - service: script.turn_on
    entity_id: script.notify_waste

- alias: Vuilbakken - Bert Thuis
  trigger:
  - platform: state
    entity_id: person.bert
    to: 'home'
  condition:
  - condition: template
    value_template: "{{ states('input_select.woning_status') in ['Thuis', 'Dag Thuis'] }}"
  - condition: template
    value_template: "{{ ((as_timestamp(now())+ (86400)) | timestamp_custom('%Y-%m-%d',true) == states.sensor.ophaalkalender_restafval.state) or ((as_timestamp(now())+ (86400)) | timestamp_custom('%Y-%m-%d',true) == states.sensor.ophaalkalender_papier.state) or ((as_timestamp(now())+ (86400)) | timestamp_custom('%Y-%m-%d',true) == states.sensor.ophaalkalender_pmd.state) }}"
  action:
  - wait_template: "{{ is_state('device_tracker.router_iphone_bert', 'home') }}"
    timeout: '00:05:00'
    continue_on_timeout: false
  - service: script.turn_on
    entity_id: script.notify_waste_ios_bert
